<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mission Hub - MathQuest: Arcade Adventures</title>
  <style>
    body {
      margin: 0;
      font-family: 'Courier New', monospace;
      background: #000;
      color: #fff;
      overflow: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .galaxy {
      position: absolute;
      width: 100%;
      height: 100%;
      z-index: 1;
      background: radial-gradient(circle, #3a0a6a 10%, #000 70%);
      animation: vortex 15s infinite linear;
    }

    @keyframes vortex {
      0% { background-position: 0 0; }
      100% { background-position: 1000px 1000px; }
    }

    .meteor {
      position: absolute;
      width: 8px;
      height: 8px;
      background: #ffeb3b;
      border-radius: 50%;
      box-shadow: 0 0 20px #ff4081;
      animation: explode 1.5s linear infinite;
    }

    @keyframes explode {
      0% { transform: translate(-50vw, -50vh); opacity: 1; }
      100% { transform: translate(50vw, 50vh); opacity: 0; }
    }

    .meteor:nth-child(1) { left: 20%; animation-delay: 0s; }
    .meteor:nth-child(2) { left: 40%; animation-delay: 0.4s; }
    .meteor:nth-child(3) { left: 60%; animation-delay: 0.8s; }
    .meteor:nth-child(4) { left: 80%; animation-delay: 1.2s; }

    .grid-floor {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 200px;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 10px,
        #00bcd4 10px,
        #00bcd4 12px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 10px,
        #00bcd4 10px,
        #00bcd4 12px
      );
      transform: perspective(500px) rotateX(60deg);
      opacity: 0.5;
      z-index: 1;
    }

    .container {
      text-align: center;
      max-width: 1000px;
      padding: 20px;
      z-index: 2;
      position: relative;
    }

    h1 {
      font-size: 5em;
      text-transform: uppercase;
      color: #ffeb3b;
      text-shadow: 0 0 20px #ff4081, 0 0 40px #00bcd4;
      animation: glitch 2s infinite;
      margin-bottom: 10px;
    }

    @keyframes glitch {
      0%, 100% { transform: translate(0); }
      20% { transform: translate(-2px, 2px); }
      40% { transform: translate(2px, -2px); }
    }

    .subtitle {
      font-size: 1.8em;
      color: #00bcd4;
      text-shadow: 0 0 10px #00bcd4;
      margin-bottom: 20px;
    }

    .spaceship {
      width: 150px;
      animation: warp 1.5s infinite;
      position: relative;
      margin-bottom: 20px;
    }

    .spaceship::after {
      content: '';
      position: absolute;
      bottom: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 20px;
      background: linear-gradient(180deg, #ff4081, transparent);
      clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
      animation: trail 0.5s infinite;
    }

    @keyframes warp {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    @keyframes trail {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    .mission-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 25px;
      justify-content: center;
    }

    .mission-button {
      background: linear-gradient(45deg, #ff4081, #ffeb3b);
      color: #000;
      padding: 12px 20px;
      font-size: 1.2em;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      box-shadow: 0 0 15px #ff4081;
      position: relative;
      overflow: hidden;
      transition: transform 0.2s;
      text-align: center;
    }

    .mission-button::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, #fff, transparent 70%);
      opacity: 0;
      top: 0;
      left: 0;
      transition: opacity 0.3s;
    }

    .mission-button:hover::after {
      opacity: 0.3;
    }

    .mission-button:hover {
      transform: scale(1.15);
    }

    .nav-bar {
      position: absolute;
      top: 20px;
      left: 20px;
      display: flex;
      gap: 10px;
      z-index: 3;
    }

    .nav-button {
      background: linear-gradient(45deg, #ff4081, #ffeb3b);
      color: #000;
      padding: 10px 20px;
      font-size: 1.1em;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 10px #ff4081;
      transition: transform 0.2s;
    }

    .nav-button:hover:not(:disabled) {
      transform: scale(1.1);
    }

    .nav-button:disabled {
      background: #ffeb3b;
      box-shadow: 0 0 10px #ffeb3b;
      cursor: default;
    }
  </style>
</head>
<body>
  <div class="galaxy">
    <div class="meteor"></div>
    <div class="meteor"></div>
    <div class="meteor"></div>
    <div class="meteor"></div>
    <div class="grid-floor"></div>
  </div>
  <div class="container">
    <h1>Mission Hub</h1>
    <p class="subtitle">Choose Your Cosmic Challenge!</p>
    <img src="images/my-spaceship.png" alt="Spaceship" class="spaceship">
    <div class="mission-buttons">
      <button class="mission-button" onclick="startMission('baseline')" onmouseover="playHoverSound()">Start Mission Here</button>
      <button class="mission-button" onclick="startMission('numbers')" onmouseover="playHoverSound()">Numbers & Operations</button>
      <button class="mission-button" onclick="startMission('algebra')" onmouseover="playHoverSound()">Patterns & Algebra</button>
      <button class="mission-button" onclick="startMission('geometry')" onmouseover="playHoverSound()">Geometry</button>
      <button class="mission-button" onclick="startMission('measurement')" onmouseover="playHoverSound()">Measurement</button>
      <button class="mission-button" onclick="startMission('data')" onmouseover="playHoverSound()">Data Handling</button>
    </div>
  </div>
  <div class="nav-bar">
    <button class="nav-button" onclick="window.location.href='index.html'; playClickSound()" onmouseover="playHoverSound()">Home</button>
    <button class="nav-button" disabled>Mission Hub</button>
    <button class="nav-button" onclick="window.location.href='reward_screen.html'; playClickSound()" onmouseover="playHoverSound()">Rewards</button>
  </div>
  <audio id="introSound" src="sounds/intro.mp3" preload="auto"></audio>
  <audio id="clickSound" src="sounds/beep.mp3" preload="auto"></audio>
  <audio id="hoverSound" src="sounds/blip.mp3" preload="auto"></audio>
  <script>
    window.onload = function() {
      try {
        const introSound = document.getElementById('introSound');
        introSound.volume = 0.5;
        introSound.play().catch(error => console.log('Intro sound failed:', error));

        const urlParams = new URLSearchParams(window.location.search);
        const grade = urlParams.get('grade') || 7;
        localStorage.setItem('mathQuestProgress', JSON.stringify({
          ...JSON.parse(localStorage.getItem('mathQuestProgress') || '{}'),
          grade: parseInt(grade)
        }));
        console.log('Loaded grade:', grade);
      } catch (error) {
        console.error('Error in window.onload:', error);
      }
    };

    function playClickSound() {
      try {
        const clickSound = document.getElementById('clickSound');
        clickSound.currentTime = 0;
        clickSound.volume = 0.5;
        clickSound.play().catch(error => console.log('Click sound failed:', error));
      } catch (error) {
        console.error('Error in playClickSound:', error);
      }
    }

    function playHoverSound() {
      try {
        const hoverSound = document.getElementById('hoverSound');
        hoverSound.currentTime = 0;
        hoverSound.volume = 0.3;
        hoverSound.play().catch(error => console.log('Hover sound failed:', error));
      } catch (error) {
        console.error('Error in playHoverSound:', error);
      }
    }

    function startMission(galaxy) {
      try {
        const progress = JSON.parse(localStorage.getItem('mathQuestProgress') || '{}');
        const grade = progress.grade || 7;
        console.log('Starting mission:', { galaxy, grade });
        const url = `game_level.html?galaxy=${galaxy}&level=${galaxy === 'baseline' ? 0 : 1}&grade=${grade}`;
        console.log('Navigating to:', url);
        window.location.href = url;
        playClickSound();
      } catch (error) {
        console.error('Error in startMission:', error);
      }
    }
  </script>
</body>
</html>